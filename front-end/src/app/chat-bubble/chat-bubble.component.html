<div
  class="flex w-full mb-2"
  [ngClass]="{
    'justify-start': message.role === 'bot',
    'justify-end': message.role === 'user'
  }"
>
  <!-- Wrapper del messaggio -->
  <div
    class="flex items-start gap-2.5 max-w-[80%]"
    [ngClass]="{
      'flex-row': message.role === 'bot',
      'flex-row-reverse': message.role === 'user'
    }"
  >
    <!-- Avatar -->
    <img
      class="w-8 h-8 rounded-full shrink-0"
      [src]="message.role === 'bot' ? 'bot.jpg' : 'user.png'"
      [alt]="message.role === 'bot' ? 'Bot avatar' : 'User avatar'"
    />

    <!-- Contenitore testo -->
    <div
      class="flex flex-col gap-1"
      [ngClass]="{
        'items-start text-left': message.role === 'bot',
        'items-end text-left': message.role === 'user'
      }"
    >
      <!-- Intestazione -->
      <div class="flex items-center space-x-2 rtl:space-x-reverse">
        <span class="text-sm font-semibold text-gray-900 dark:text-white">
          {{ message.role === 'bot' ? 'Enterprise Bot' : 'Andrea Napoli' }}
        </span>
      </div>

      <!-- Messaggio testuale -->
      <div *ngIf="message.text"
        class="inline-block px-4 py-2 border rounded-xl break-words whitespace-pre-wrap"
        [ngClass]="message.role === 'bot'
          ? 'bg-gray-300 dark:bg-gray-800 text-gray-900 dark:text-white border-gray-200 dark:border-gray-600 rounded-e-xl rounded-es-xl'
          : 'bg-gray-200 dark:bg-gray-600 text-black dark:text-white border-gray-400 rounded-s-xl rounded-ee-xl'"
      >
        <p class="text-sm font-normal">{{ message.text }}</p>
      </div>

      <!-- Immagine -->
      <div *ngIf="message.image" class="mt-2">
        <img
          [src]="message.image"
          alt="Immagine dal bot"
          class="rounded-xl border border-gray-200 dark:border-gray-700 w-auto max-w-full"
        />
      </div>

      <!-- Pulsanti -->
      <div *ngIf="message.buttons" class="flex flex-wrap gap-2 mt-2">
        <button *ngFor="let btn of message.buttons"
                (click)="sendButtonPayload(btn.payload)"
                class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded shadow transition duration-200">
          {{ btn.title }}
        </button>
      </div>

      <!-- Orario -->
      <span class="text-xs font-normal text-gray-500 dark:text-gray-400">
        {{ message.time }}
      </span>
    </div>
  </div>
</div>
