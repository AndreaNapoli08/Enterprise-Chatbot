version: "3.1"

rules:

- rule: Saluta ogni volta che l'utente saluta
  steps:
  - intent: greet
  - action: utter_greet
  - action: action_reset_fallback

- rule: Ringrazia ogni volta che l'utente abbandona la chat
  steps:
  - intent: goodbye
  - action: utter_ask_option_close_conversation

- rule: Dì "Sono un bot" ogni volta che l'utente lo chiede
  steps:
  - intent: bot_challenge
  - action: utter_iamabot
  - action: action_reset_fallback

- rule: L'utente vuole cercare nei documenti
  steps:
    - intent: choose_yes_document
    - action: action_list_available_documents

- rule: L'utente sceglie un documento e parte la ricerca
  steps:
    - intent: choose_document
    - action: action_answer_from_chroma

- rule: L'utente non vuole cercare nei documenti
  steps:
    - intent: choose_no_document
    - action: utter_option_no
    - action: action_handle_fallback

- rule: L'utente vuole chiudere la conversazione
  steps:
    - intent: yes_close_conversation
    - action: utter_close_conversation

- rule: L'utente non vuole chiudere la conversazione
  steps:
    - intent: no_close_conversation
    - action: utter_no_close_conversation
    - action: action_reset_fallback

- rule: Mostra un documento
  steps:
  - intent: ask_document
  - action: action_send_local_pdf
  - action: action_reset_fallback

- rule: Gestione out_of_scope
  steps:
  - intent: out_of_scope
  - action: utter_out_of_scope
  - action: action_reset_fallback

- rule: Gestione fine della conversazione
  steps:
  - intent: conversation_end
  - action: utter_ask_option_close_conversation
  - action: action_reset_fallback

- rule: Gestione fallback
  steps:
  - intent: nlu_fallback
  - action: utter_fallback
  - action: utter_ask_option_search_document

- rule: Ricorda lo stato d'animo
  steps:
  - intent: ask_mood
  - action: action_query_context
  - action: action_reset_fallback

- rule: Rispondi se l'utente è felice
  steps:
  - intent: mood_great
  - action: action_save_context
  - action: utter_happy
  - action: action_reset_fallback

- rule: Rispondi se l'utente è triste
  steps:
  - intent: mood_unhappy
  - action: action_save_context
  - action: utter_cheer_up
  - action: action_reset_fallback

- rule: Rispondi a domande sul documento linee_guida
  steps:
    - intent: ask_information_relazione
    - action: action_answer_from_chroma

- rule: Rispondi a domande sul documento aziendale
  steps:
    - intent: ask_information_aziendale
    - action: action_answer_from_chroma